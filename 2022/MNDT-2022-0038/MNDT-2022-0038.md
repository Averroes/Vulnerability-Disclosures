# MNDT-2022-0038

## Description
Mandiant consultants discovered a vulnerability that impacts Microsoft’s Windows operating system, allowing an attacker to execute code on remote systems by abusing an Arbitrary File Write vulnerability in the Windows Credential Roaming service. 

## Impact
Very High - An attacker can abuse this vulnerability to execute unauthorized code (in the context of the victim user) and create arbitrary files on remote systems.

## Exploitability
Medium - An attacker requires write access to the victim user’s Active Directory account in order to exploit this vulnerability.

## CVE Reference
CVE-2022-30170

## Technical Details
A Remote Code Execution (RCE) vulnerability exists within the Windows Credential Roaming service where an attacker can abuse an Arbitrary File Write (AFW) vulnerability to create an arbitrary file in the “Startup” directory of the victim user. The arbitrary file is then executed the next time the victim user logs in to the system.

## Mitigation
Microsoft assigned CVE-2022-30170 and published [KB5017365](https://support.microsoft.com/en-us/topic/september-13-2022-kb5017365-security-only-update-609c64f3-f2c6-46cb-b2c3-f86b55670498) and [KB5017367](https://support.microsoft.com/en-us/topic/september-13-2022-kb5017367-monthly-rollup-3dd52c1e-552a-43df-a06e-4bdb3746c373) on *September 13 2022* to address the issue.

## Discovery Credits
Thibault Van Geluwe de Berlaere, Mandiant

## Disclosure Timeline
* 20 April 2022 - Issue submitted to Microsoft
* 26 April 2022 - Case opened
* 18 May 2022 - Microsoft confirms issue
* 01 June 2022 - Microsoft classifies issue as a 'Defense in Depth' vulnerability
* 07 June 2022 - Re-explain scope and impact to MSRC
* 09 June 2022 - MSRC re-evaluates severity of the issue
* 17 June 2022 - MSRC assigns CVE-2022-30170
* 13 September 2022 - Patch released

## References
* [Microsoft Advisory: CVE-2022-30170](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-30170)
