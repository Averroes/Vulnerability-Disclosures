# MNDT-2022-0039
## Description
An Elevation of Privilege Vulnerability exists in Microsoft's Windows Common Log File System Driver(clfs.sys) when a specially crafted Base Log File(blf) is parsed. 

## Impact
High - Exploiting the vulnerability will give a local unprivileged attacker SYSTEM level privileges. 

## Exploitability
High - Any authenticated local user can exploit the vulnerability and an exploit is trivial to produce.

## CVE Reference
CVE-2022-37969

## Common Vulnerability Scoring System
Base Score: 7.8 - Vector: AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

## Technical Details
The `SignaturesOffset` field of BLF's log block header can be manipulated when a specially crafted BLF file being parsed, that leads to an out-of-bound write when allocating symbol and corrupts certain object's virtual function table pointer. This in the wild exploit escalates the privilege to `SYSTEM`.

## Resolution
The issue was fixed as part of September 2022 Microsoft security update. Update to address the vulnerability.

## Discovery Credits
- Genwei Jiang, Mandiant, FLARE OTF

## Disclosure Timeline
- 01-Sep-2021 - Issue reported to MSFT
- 13-Sep-2022 - Patched version released by MSFT
 
## References
- [Microsoft Advisory](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-37969)
- [CLFS Internals, Log Block Header](https://github.com/ionescu007/clfs-docs#log-block-header)
