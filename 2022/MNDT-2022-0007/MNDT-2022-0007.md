# MNDT-2022-0007
Splashtop Streamer for Windows contains a local privilege escalation vulnerability prior to version 3.5.0.0

## Impact
High - Exploiting the vulnerability will give a local unprivileged attacker SYSTEM level privileges. 

## Exploitability
Medium - Any authenticated local user can exploit the vulnerability and an exploit is trivial to produce.

## CVE Reference
CVE-2021-42712

## Common Weakness Enumeration
CWE-379: Creation of Temporary File in Directory with Insecure Permissions

## Common Vulnerability Scoring System
Base Score: 7.8 - Vector: AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

## Technical Details
The installation of the agent uses the Windows Installer framework and an MSI file is cached in c:\windows\installer. An unprivileged user can trigger a repair operation, either by using the Windows Installer API or by running "msiexec.exe /fa c:\windows\installer\\\[XXXXX].msi". 

Running a repair operation will trigger a number of file operations in the %TEMP% folder of the user triggering the repair. Some of these operations will be performed from a SYSTEM context (started via the Windows Installer service), including the execution of temporary files. 

## Resolution
The issue was fixed in version 3.5.0.0. Update to this version to address the vulnerability.

## Discovery Credits
- Ronnie Salomonsen, Mandiant

## Disclosure Timeline
- 15-Oct-2021 - Issue reported to Splashtop
- 19-Oct-2021 - Issue confirmed by Splashtop and a fix scheduled for January 25, 2022.
- 25-Jan-2022 - Patched version released by Splashtop
 
## References
- [Splashtop Streamer for Windows v3.5.0.0 - released](https://support-splashtopbusiness.splashtop.com/hc/en-us/articles/4416188695323-Splashtop-Streamer-version-v3-5-0-0-for-Windows-released-includes-SOS-version-3-5-0-0)
- [Mitre CVE-2021-42712](https://www.cve.org/CVERecord?id=CVE-2021-42712)
