# MNDT-2022-0002
Thales SafeNet Agent for Remote Desktop Gateway for Windows contains a local privilege escalation vulnerability prior to version 2.0.4

## Impact
High - Exploiting the vulnerability will give a local unprivileged attacker SYSTEM level privileges. 

## Exploitability
Medium - Any authenticated local user can exploit the vulnerability and an exploit is trivial to produce.

## CVE Reference
CVE-2021-42810

## Common Weakness Enumeration
CWE-379: Creation of Temporary File in Directory with Insecure Permissions

## Technical Details
The installation of the agent uses the Windows Installer framework and an MSI file is cached in c:\windows\installer. An unprivileged user can trigger a repair operation, either by using the Windows Installer API or by running "msiexec.exe /fa c:\windows\installer\\\[XXXXX].msi". 

Running a repair operation will trigger a number of file operations in the %TEMP% folder of the user triggering the repair. Some of these operations will be performed from a SYSTEM context (started via the Windows Installer service), including the execution of temporary files. 

## Resolution
The issue was fixed in version 2.0.4. Update to this version to address the vulnerability.

## Discovery Credits
- Ronnie Salomonsen, Mandiant

## Disclosure Timeline
- 14-Oct-2021 - Issue reported to Thales
- 16-Nov-2021 - Issue confirmed by Thales and a fix scheduled for January 19, 2022.
- 19-Jan-2022 - Patched version released by Thales
 
## References
- https://supportportal.gemalto.com/csm?sys_kb_id=39c74a10db890110520c47050596190c&id=kb_article_view&sysparm_rank=1&sysparm_tsqueryId=96684690db890110520c4705059619b8&sysparm_article=KB0025414
- https://supportportal.gemalto.com/csm?id=kb_article_view&sys_kb_id=5e62a1181b094110f9dca6886e4bcb9e&sysparm_article=KB0025411
- https://supportportal.gemalto.com/csm?id=kb_article_view&sys_kb_id=720825d81b894110f9dca6886e4bcb39&sysparm_article=KB0025412
- https://www.cve.org/CVERecord?id=CVE-2021-42810
