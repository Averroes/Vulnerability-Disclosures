# MNDT-2022-0033
## Description
The fseventsd daemon serves to watch and handle notifications passed via the FSEvents API in Apple's Mac OS.  The daemon is responsible for insecurely creating several files when disks are mounted inside the mountpoint’s .fseventsd directory.  
 
## Impact
High - Exploiting the vulnerability will give a local unprivileged attacker root level privileges. 

## Exploitability
Medium - Any authenticated local user can exploit the vulnerability.

## CVE Reference
CVE-2022-32819

## Common Weakness Enumeration
CWE-61: UNIX Symbolic Link (Symlink) Following

## Common Vulnerability Scoring System
Base Score: 7.8 - Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C/CR:L/IR:L/AR:L

## Technical Details
The fseventsd daemon serves to watch and handle notifications passed via the FSEvents API in Apple's Mac OS.  It insecurely creates several files when disks are mounted inside the mountpoint’s .fseventsd directory.  While these file opens do employ the O_NOFOLLOW flag and thus cannot be directly symlinked, the path itself can be symlink’d and it will create these root-owned files in any directory the attacker so chooses.  This allows arbitrary root file creation with limited control over either the file name or the file contents.  

## Resolution
The issue was fixed by Apple's July 20th, 2022 security updates.  Update your device to the relevant new version for your device to address the vulnerability.

## Discovery Credits
- Joshua Mason, Mandiant

## Disclosure Timeline
- 12-Apr-2022 - Issue reported to Apple
- 13-Jul-2022 - Issue confirmed by Apple and patch planned
- 20-Jul-2022 - Patches released for affected operating systems/devices.

## References
- [Mitre CVE-2022-32819](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-32819)
- [Apple macOS Monterey 12.5](https://support.apple.com/en-us/HT213345)
