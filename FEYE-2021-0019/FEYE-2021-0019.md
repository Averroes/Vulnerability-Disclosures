# FEYE-2021-0019
Wpantund contains stack overflow vulnerability for all the versions from 4ae4619d7db67db8f316507ceb91879221da0c42 to bf45115f41ba2b8029eda174be2b93dea73b9261 (both of the commits inclusive)

## Impact
Medium - 2 byte stack overflow may cause code execution or denial of service 

## Exploitability
Low - An attacker must have access to the device.

## CVE Reference
CVE-2021-33889

## Techinical Details
Stack buffer overflow may be triggered while writing to a variable metric_len, which is defined as unsigned short (ref: https://github.com/openthread/wpantund/blob/master/src/ncp-spinel/SpinelNCPInstance.cpp#L2180) but is considered as unsigned int (ref: https://github.com/openthread/wpantund/blob/master/third_party/openthread/src/ncp/spinel.c#L597).

## Resolution
The issue is fixed in commit 2b6f6c54bba3ab397f0e83f9d5e9faee905ac559. The commit is yet to be merged as of 2 July 2021.

## Discovery Credits
- Rushikesh D. Nandedkar, FireEye Mandiant
 

## Disclosure Timeline
- Reported on: 28 June 2021
- Submitted Patch: 28 June 2021

## References
- https://github.com/openthread/wpantund/issues/502
- https://github.com/openthread/wpantund/pull/503/commits/2b6f6c54bba3ab397f0e83f9d5e9faee905ac559
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33889